Option Explicit

Dim objExcel, objFSO, csvFile, saveFolder
Dim objWorkbook, objWorksheet
Dim lastRow, appCol, dict, cell, appName, key
Dim tempWB, tempWS

Set objExcel = CreateObject("Excel.Application")
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set dict = CreateObject("Scripting.Dictionary")

objExcel.Visible = False
appCol = 2 ' Application column number

csvFile = InputBox("Enter full path to CSV file:", "Source CSV")
If csvFile = "" Then WScript.Quit
If Not objFSO.FileExists(csvFile) Then
    MsgBox "File not found: " & csvFile, vbCritical
    WScript.Quit
End If

saveFolder = BrowseForFolder("Select folder to save output")
If saveFolder = "" Then WScript.Quit

Set objWorkbook = objExcel.Workbooks.Open(csvFile)
Set objWorksheet = objWorkbook.Sheets(1)

lastRow = objWorksheet.Cells(objWorksheet.Rows.Count, appCol).End(-4162).Row

For Each cell In objWorksheet.Range(objWorksheet.Cells(2, appCol), objWorksheet.Cells(lastRow, appCol))
    appName = Trim(cell.Value)
    If Len(appName) > 0 Then
        If Not dict.Exists(appName) Then dict.Add appName, True
    End If
Next

objExcel.ScreenUpdating = False
For Each key In dict.Keys
    objWorksheet.UsedRange.AutoFilter Field:=appCol, Criteria1:=key
    Set tempWB = objExcel.Workbooks.Add
    Set tempWS = tempWB.Sheets(1)
    objWorksheet.UsedRange.SpecialCells(12).Copy
    tempWS.Range("A1").PasteSpecial -4163
    tempWB.SaveAs saveFolder & "\" & CleanFileName(key) & ".csv", 6
    tempWB.Close False
Next

objWorksheet.AutoFilterMode = False
objWorkbook.Close False
objExcel.Quit

MsgBox "Done! Files saved in: " & saveFolder, vbInformation

Function CleanFileName(str)
    Dim badChars, ch
    badChars = Array("\", "/", ":", "*", "?", """", "<", ">", "|")
    For Each ch In badChars
        str = Replace(str, ch, "_")
    Next
    CleanFileName = str
End Function

Function BrowseForFolder(title)
    Dim objShell, folder
    Set objShell = CreateObject("Shell.Application")
    Set folder = objShell.BrowseForFolder(0, title, 0, 0)
    If TypeName(folder) = "Nothing" Then
        BrowseForFolder = ""
    Else
        BrowseForFolder = folder.Self.Path
    End If
End Function
